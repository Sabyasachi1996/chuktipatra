function encryptByAES(string, key) {
    var encrypted = CryptoJS.AES.encrypt(string, CryptoJS.enc.Utf8.parse(key), { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 });
    var encrypted_val = encrypted.ciphertext.toString(CryptoJS.enc.Hex);
    return encrypted_val;
}

function decryptByAES(string, key) {
    var decrypted = CryptoJS.AES.decrypt({ciphertext: CryptoJS.enc.Hex.parse(string)}, CryptoJS.enc.Utf8.parse(key), { mode: CryptoJS.mode.ECB, padding: CryptoJS.pad.Pkcs7 });
    decrypted_val = decrypted.toString(CryptoJS.enc.Utf8);
    return decrypted_val;
}

function getValById(id) {
    var val = $('#' + id).val();
    return $.trim(val);
}

function showSnacBar(message, type) {
    if ($(".flash-message").length > 0) {
        $(".flash-message").remove();
    }
    var classname = "flash-message alert";
    if (type == "success") {
        classname += " border-success";
    } else if (type == "error") {
        classname += " border-danger";
    } else if (type == "warning") {
        classname += " border-warning";
    }
    var $close = $("<i>", { class: 'las la-times flash-msg-close'});
    var $div = $("<div>", { class: classname, role: "alert" });
    $div.html(message).append($close);
    $("body").append($div);

    hideSnackBar();
}

function hideSnackBar() {
    //hide flash message
    if ($(".flash-message").length > 0) {
        setTimeout(() => {
            $(".flash-message").fadeOut("slow");
        }, 4000);
    }
}

$(document).on('click', '.flash-msg-close', function () {
    $(".flash-message").fadeOut("slow");
});

function showError(ele, msg) {
    $("#" + ele).addClass("is-invalid");
    $("#" + ele)
        .parent()
        .append('<small class="form-error text-danger">' + msg + "</small>");
    error = true;
}

function showErrorByClass(ele, msg) {
    $("." + ele).addClass("is-invalid");
    $("." + ele)
        .parent()
        .append('<small class="form-error text-danger">' + msg + "</small>");
    error = true;
}

//hide error message
function hideError(ele) {
    $("#" + ele).removeClass("is-invalid");
    $("#" + ele)
        .parent()
        .find($(".form-error"))
        .remove();
}
function hideErrorByClass(ele) {
    $("." + ele).removeClass("is-invalid");
    $("." + ele)
        .parent()
        .find($(".form-error"))
        .remove();
}

function getFormFieldValById(id) {
    var val = $('#' + id).val();
    return val.trim();
}

//trim spaces
function trimSpace(val) {
    return val.replace(/^\s*/, "").replace(/\s*$/, "");
}

//accepts number only
$(".number").keypress(function (key) {
    if (key.charCode == 0) return true;
    if (key.charCode < 48 || key.charCode > 57) return false;
});

//converts to upper
$(".upper").on('keyup', function (e) {
    $(this).val($(this).val().toUpperCase());
});

//validate mobile num
function validateMobile(mobilenum) {
    var is_valid = mobilenum.match("[0-9]{10}");
    if (null === is_valid) {
        return false;
    } else {
        return true;
    }
}

//validate email address
function validateEmail(emailadd) {
    var re = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
    var is_valid = re.test(emailadd);
    if (!is_valid) {
        return false;
    } else {
        return true;
    }
}

$("input.decimal").bind("change keyup input", function () {
    var position = this.selectionStart - 1;
    //remove all but number and .
    var fixed = this.value.replace(/[^0-9\.]/g, "");
    if (fixed.charAt(0) === ".")
        //can't start with .
        fixed = fixed.slice(1);

    var pos = fixed.indexOf(".") + 1;
    if (pos >= 0)
        //avoid more than one .
        fixed = fixed.substr(0, pos) + fixed.slice(pos).replace(".", "");

    if (this.value !== fixed) {
        this.value = fixed;
        this.selectionStart = position;
        this.selectionEnd = position;
    }
});

$('.submit').keypress(function (e) {
    if (e.which == 13) {
        $(this).closest('form').submit();
        return false;
    }
});

$(document).on("click", ".btn-close", function () {
    var el = $('.modal').attr("id");
    $('#' + el).modal('hide');
});

//encrypt value
$(document).on("click", ".btn-encrypt", function () {
    var encrypt =   $('#encrypt_val').val();
    var params = "encrypt_data=" + encrypt;
    $.ajax({
        url: BASE_URL + "do-encrypt",
        type: "post",
        data: params,
        dataType: "json",
        headers: {
            "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content")
        },
        success: function (response) {
            $('.encrypt_val').show();
            $('.encrypted-val').html(response.value);
        },
    });
});

//decrypt value
$(document).on("click", ".btn-decrypt", function () {
    var decrypt =   $('#decrypt_val').val();
    var params = "decrypt_data=" + encodeURIComponent(decrypt);
    $.ajax({
        url: BASE_URL + "do-decrypt",
        type: "post",
        data: params,
        dataType: "json",
        headers: {
            "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content")
        },
        success: function (response) {
            $('.decrypt_val').show();
            $('.decrypted-val').html(response.value);
        },
    });
});
function callSignOut(){
    var params= {flag:"adminLogout"}
    $.ajax({
        url: BASE_URL + "admin/logout",
        type: "post",
        data: params,
        dataType: "json",
        headers: {
            "X-CSRF-TOKEN": $('meta[name="csrf-token"]').attr("content"),
        },
        cache: false,
        beforeSend: function () {
        },
        success: function (response) {
            if (response.error) {
                $(".btn-admin-login-send-otp").attr("disabled", false);
                showSnacBar(response.message, "error");
                setTimeout(function(){
                 location.reload();
                },1500);
            } else {
                sessionStorage.clear();
                showSnacBar(response.message, "success");
                setTimeout(function(){
                    location.href=BASE_URL+"admin"
                },1500);
            }
        },
    }); 
}
$(document).ready(function () {
    hideSnackBar();
});
